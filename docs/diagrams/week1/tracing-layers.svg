<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1920 1080">
  <defs>
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#3b82f6"/>
      <stop offset="50%" style="stop-color:#8b5cf6"/>
      <stop offset="100%" style="stop-color:#f97316"/>
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="1920" height="1080" fill="#020617"/>

  <!-- Title -->
  <rect x="0" y="0" width="1920" height="70" fill="url(#headerGrad)"/>
  <text x="960" y="46" font-family="Inter, system-ui, sans-serif" font-size="28" font-weight="700" fill="white" text-anchor="middle">Three Layers of ML Observability</text>

  <!-- ==================== LAYER STACK (Left side) ==================== -->
  <g transform="translate(60, 110)">
    <text x="380" y="30" font-family="Inter, system-ui, sans-serif" font-size="18" font-weight="700" fill="white" text-anchor="middle">Stack</text>

    <!-- Layer 1: Request (Blue) -->
    <g transform="translate(0, 60)">
      <rect width="760" height="180" rx="16" fill="#1e3a8a" stroke="#3b82f6" stroke-width="3"/>

      <circle cx="50" cy="90" r="30" fill="#3b82f6"/>
      <text x="50" y="98" font-family="Inter, system-ui, sans-serif" font-size="24" font-weight="700" fill="white" text-anchor="middle">1</text>

      <text x="110" y="50" font-family="Inter, system-ui, sans-serif" font-size="20" font-weight="700" fill="white">Request Tracing</text>
      <text x="110" y="75" font-family="JetBrains Mono, monospace" font-size="12" fill="#93c5fd">X-Trace-Level: brick</text>

      <g transform="translate(110, 95)">
        <circle cx="8" cy="8" r="4" fill="#3b82f6"/>
        <text x="22" y="12" font-family="Inter, system-ui, sans-serif" font-size="13" fill="#94a3b8">Request latency</text>
      </g>
      <g transform="translate(110, 120)">
        <circle cx="8" cy="8" r="4" fill="#3b82f6"/>
        <text x="22" y="12" font-family="Inter, system-ui, sans-serif" font-size="13" fill="#94a3b8">Token counts</text>
      </g>
      <g transform="translate(110, 145)">
        <circle cx="8" cy="8" r="4" fill="#3b82f6"/>
        <text x="22" y="12" font-family="Inter, system-ui, sans-serif" font-size="13" fill="#94a3b8">Per-token timing</text>
      </g>

      <g transform="translate(400, 50)">
        <rect width="320" height="110" rx="8" fill="#0f172a"/>
        <text x="160" y="30" font-family="Inter, system-ui, sans-serif" font-size="12" font-weight="600" fill="#93c5fd" text-anchor="middle">Overhead</text>
        <text x="60" y="60" font-family="JetBrains Mono, monospace" font-size="11" fill="#64748b">none:</text>
        <text x="140" y="60" font-family="JetBrains Mono, monospace" font-size="11" fill="#22c55e">0%</text>
        <text x="60" y="80" font-family="JetBrains Mono, monospace" font-size="11" fill="#64748b">basic:</text>
        <text x="140" y="80" font-family="JetBrains Mono, monospace" font-size="11" fill="#22c55e">&lt;1%</text>
        <text x="60" y="100" font-family="JetBrains Mono, monospace" font-size="11" fill="#64748b">brick:</text>
        <text x="140" y="100" font-family="JetBrains Mono, monospace" font-size="11" fill="#f59e0b">~5%</text>
      </g>
    </g>

    <!-- Layer 2: Model (Purple) -->
    <g transform="translate(0, 270)">
      <rect width="760" height="180" rx="16" fill="#4c1d95" stroke="#8b5cf6" stroke-width="3"/>

      <circle cx="50" cy="90" r="30" fill="#8b5cf6"/>
      <text x="50" y="98" font-family="Inter, system-ui, sans-serif" font-size="24" font-weight="700" fill="white" text-anchor="middle">2</text>

      <text x="110" y="50" font-family="Inter, system-ui, sans-serif" font-size="20" font-weight="700" fill="white">Layer Tracing</text>
      <text x="110" y="75" font-family="JetBrains Mono, monospace" font-size="12" fill="#c4b5fd">apr trace model.apr</text>

      <g transform="translate(110, 95)">
        <circle cx="8" cy="8" r="4" fill="#8b5cf6"/>
        <text x="22" y="12" font-family="Inter, system-ui, sans-serif" font-size="13" fill="#94a3b8">Tensor statistics</text>
      </g>
      <g transform="translate(110, 120)">
        <circle cx="8" cy="8" r="4" fill="#8b5cf6"/>
        <text x="22" y="12" font-family="Inter, system-ui, sans-serif" font-size="13" fill="#94a3b8">NaN/Inf detection</text>
      </g>
      <g transform="translate(110, 145)">
        <circle cx="8" cy="8" r="4" fill="#8b5cf6"/>
        <text x="22" y="12" font-family="Inter, system-ui, sans-serif" font-size="13" fill="#94a3b8">Activation anomalies</text>
      </g>

      <g transform="translate(400, 50)">
        <rect width="320" height="110" rx="8" fill="#0f172a"/>
        <text x="160" y="30" font-family="Inter, system-ui, sans-serif" font-size="12" font-weight="600" fill="#c4b5fd" text-anchor="middle">Overhead</text>
        <text x="60" y="70" font-family="JetBrains Mono, monospace" font-size="11" fill="#64748b">stats:</text>
        <text x="140" y="70" font-family="JetBrains Mono, monospace" font-size="11" fill="#f59e0b">~15%</text>
        <text x="60" y="95" font-family="Inter, system-ui, sans-serif" font-size="10" fill="#64748b">Use offline only</text>
      </g>
    </g>

    <!-- Layer 3: System (Orange) -->
    <g transform="translate(0, 480)">
      <rect width="760" height="180" rx="16" fill="#7c2d12" stroke="#f97316" stroke-width="3"/>

      <circle cx="50" cy="90" r="30" fill="#f97316"/>
      <text x="50" y="98" font-family="Inter, system-ui, sans-serif" font-size="24" font-weight="700" fill="white" text-anchor="middle">3</text>

      <text x="110" y="50" font-family="Inter, system-ui, sans-serif" font-size="20" font-weight="700" fill="white">System Tracing</text>
      <text x="110" y="75" font-family="JetBrains Mono, monospace" font-size="12" fill="#fdba74">apr cbtop --headless</text>

      <g transform="translate(110, 95)">
        <circle cx="8" cy="8" r="4" fill="#f97316"/>
        <text x="22" y="12" font-family="Inter, system-ui, sans-serif" font-size="13" fill="#94a3b8">Syscall profiling</text>
      </g>
      <g transform="translate(110, 120)">
        <circle cx="8" cy="8" r="4" fill="#f97316"/>
        <text x="22" y="12" font-family="Inter, system-ui, sans-serif" font-size="13" fill="#94a3b8">Memory allocations</text>
      </g>
      <g transform="translate(110, 145)">
        <circle cx="8" cy="8" r="4" fill="#f97316"/>
        <text x="22" y="12" font-family="Inter, system-ui, sans-serif" font-size="13" fill="#94a3b8">GPU / PCIe bandwidth</text>
      </g>

      <g transform="translate(400, 50)">
        <rect width="320" height="110" rx="8" fill="#0f172a"/>
        <text x="160" y="30" font-family="Inter, system-ui, sans-serif" font-size="12" font-weight="600" fill="#fdba74" text-anchor="middle">Overhead</text>
        <text x="60" y="70" font-family="JetBrains Mono, monospace" font-size="11" fill="#64748b">syscall:</text>
        <text x="140" y="70" font-family="JetBrains Mono, monospace" font-size="11" fill="#ef4444">~30%</text>
        <text x="60" y="95" font-family="Inter, system-ui, sans-serif" font-size="10" fill="#64748b">Never in production</text>
      </g>
    </g>

    <!-- Depth label -->
    <g transform="translate(-40, 150)">
      <text x="0" y="250" font-family="Inter, system-ui, sans-serif" font-size="12" fill="#64748b" text-anchor="middle" transform="rotate(-90, 0, 250)">← Deeper visibility</text>
    </g>
  </g>

  <!-- ==================== WHEN TO USE (Right side) ==================== -->
  <g transform="translate(900, 110)">
    <text x="480" y="30" font-family="Inter, system-ui, sans-serif" font-size="18" font-weight="700" fill="white" text-anchor="middle">When to Use</text>

    <!-- Request use cases -->
    <g transform="translate(0, 60)">
      <rect width="960" height="180" rx="16" fill="#0f172a" stroke="#3b82f6" stroke-width="2"/>
      <text x="30" y="40" font-family="Inter, system-ui, sans-serif" font-size="16" font-weight="700" fill="#93c5fd">Request Tracing</text>

      <g transform="translate(30, 60)">
        <rect width="280" height="100" rx="10" fill="#1e3a8a" opacity="0.5"/>
        <text x="140" y="30" font-family="Inter, system-ui, sans-serif" font-size="13" font-weight="600" fill="white" text-anchor="middle">Production SLO</text>
        <text x="140" y="55" font-family="Inter, system-ui, sans-serif" font-size="11" fill="#94a3b8" text-anchor="middle">Monitor P99 latency</text>
        <text x="140" y="75" font-family="Inter, system-ui, sans-serif" font-size="11" fill="#94a3b8" text-anchor="middle">Track TTFT</text>
      </g>

      <g transform="translate(330, 60)">
        <rect width="280" height="100" rx="10" fill="#1e3a8a" opacity="0.5"/>
        <text x="140" y="30" font-family="Inter, system-ui, sans-serif" font-size="13" font-weight="600" fill="white" text-anchor="middle">Debug Slow Requests</text>
        <text x="140" y="55" font-family="Inter, system-ui, sans-serif" font-size="11" fill="#94a3b8" text-anchor="middle">Find spike tokens</text>
        <text x="140" y="75" font-family="Inter, system-ui, sans-serif" font-size="11" fill="#94a3b8" text-anchor="middle">Identify bottlenecks</text>
      </g>

      <g transform="translate(630, 60)">
        <rect width="280" height="100" rx="10" fill="#1e3a8a" opacity="0.5"/>
        <text x="140" y="30" font-family="Inter, system-ui, sans-serif" font-size="13" font-weight="600" fill="white" text-anchor="middle">A/B Testing</text>
        <text x="140" y="55" font-family="Inter, system-ui, sans-serif" font-size="11" fill="#94a3b8" text-anchor="middle">Compare model versions</text>
        <text x="140" y="75" font-family="Inter, system-ui, sans-serif" font-size="11" fill="#94a3b8" text-anchor="middle">Measure impact</text>
      </g>
    </g>

    <!-- Layer use cases -->
    <g transform="translate(0, 270)">
      <rect width="960" height="180" rx="16" fill="#0f172a" stroke="#8b5cf6" stroke-width="2"/>
      <text x="30" y="40" font-family="Inter, system-ui, sans-serif" font-size="16" font-weight="700" fill="#c4b5fd">Layer Tracing</text>

      <g transform="translate(30, 60)">
        <rect width="280" height="100" rx="10" fill="#4c1d95" opacity="0.5"/>
        <text x="140" y="30" font-family="Inter, system-ui, sans-serif" font-size="13" font-weight="600" fill="white" text-anchor="middle">Debug NaN</text>
        <text x="140" y="55" font-family="Inter, system-ui, sans-serif" font-size="11" fill="#94a3b8" text-anchor="middle">Find source layer</text>
        <text x="140" y="75" font-family="Inter, system-ui, sans-serif" font-size="11" fill="#94a3b8" text-anchor="middle">Track propagation</text>
      </g>

      <g transform="translate(330, 60)">
        <rect width="280" height="100" rx="10" fill="#4c1d95" opacity="0.5"/>
        <text x="140" y="30" font-family="Inter, system-ui, sans-serif" font-size="13" font-weight="600" fill="white" text-anchor="middle">Validate Quantization</text>
        <text x="140" y="55" font-family="Inter, system-ui, sans-serif" font-size="11" fill="#94a3b8" text-anchor="middle">Compare vs float</text>
        <text x="140" y="75" font-family="Inter, system-ui, sans-serif" font-size="11" fill="#94a3b8" text-anchor="middle">Check distribution</text>
      </g>

      <g transform="translate(630, 60)">
        <rect width="280" height="100" rx="10" fill="#4c1d95" opacity="0.5"/>
        <text x="140" y="30" font-family="Inter, system-ui, sans-serif" font-size="13" font-weight="600" fill="white" text-anchor="middle">Regression Test</text>
        <text x="140" y="55" font-family="Inter, system-ui, sans-serif" font-size="11" fill="#94a3b8" text-anchor="middle">Diff vs golden</text>
        <text x="140" y="75" font-family="Inter, system-ui, sans-serif" font-size="11" fill="#94a3b8" text-anchor="middle">Catch drift</text>
      </g>
    </g>

    <!-- System use cases -->
    <g transform="translate(0, 480)">
      <rect width="960" height="180" rx="16" fill="#0f172a" stroke="#f97316" stroke-width="2"/>
      <text x="30" y="40" font-family="Inter, system-ui, sans-serif" font-size="16" font-weight="700" fill="#fdba74">System Tracing</text>

      <g transform="translate(30, 60)">
        <rect width="280" height="100" rx="10" fill="#7c2d12" opacity="0.5"/>
        <text x="140" y="30" font-family="Inter, system-ui, sans-serif" font-size="13" font-weight="600" fill="white" text-anchor="middle">Memory Leaks</text>
        <text x="140" y="55" font-family="Inter, system-ui, sans-serif" font-size="11" fill="#94a3b8" text-anchor="middle">Track allocations</text>
        <text x="140" y="75" font-family="Inter, system-ui, sans-serif" font-size="11" fill="#94a3b8" text-anchor="middle">Find unfreed tensors</text>
      </g>

      <g transform="translate(330, 60)">
        <rect width="280" height="100" rx="10" fill="#7c2d12" opacity="0.5"/>
        <text x="140" y="30" font-family="Inter, system-ui, sans-serif" font-size="13" font-weight="600" fill="white" text-anchor="middle">GPU Bottlenecks</text>
        <text x="140" y="55" font-family="Inter, system-ui, sans-serif" font-size="11" fill="#94a3b8" text-anchor="middle">PCIe bandwidth</text>
        <text x="140" y="75" font-family="Inter, system-ui, sans-serif" font-size="11" fill="#94a3b8" text-anchor="middle">Kernel timing</text>
      </g>

      <g transform="translate(630, 60)">
        <rect width="280" height="100" rx="10" fill="#7c2d12" opacity="0.5"/>
        <text x="140" y="30" font-family="Inter, system-ui, sans-serif" font-size="13" font-weight="600" fill="white" text-anchor="middle">Resource Profiling</text>
        <text x="140" y="55" font-family="Inter, system-ui, sans-serif" font-size="11" fill="#94a3b8" text-anchor="middle">CPU vs GPU split</text>
        <text x="140" y="75" font-family="Inter, system-ui, sans-serif" font-size="11" fill="#94a3b8" text-anchor="middle">Optimize hardware</text>
      </g>
    </g>
  </g>

  <!-- ==================== BOTTOM: Quick Reference ==================== -->
  <g transform="translate(60, 790)">
    <rect width="1800" height="80" rx="12" fill="#0f172a" stroke="#64748b" stroke-width="1"/>

    <g transform="translate(100, 25)">
      <circle cx="15" cy="20" r="10" fill="#3b82f6"/>
      <text x="35" y="18" font-family="Inter, system-ui, sans-serif" font-size="13" fill="white">Request</text>
      <text x="35" y="35" font-family="Inter, system-ui, sans-serif" font-size="11" fill="#64748b">Production safe</text>
    </g>

    <g transform="translate(500, 25)">
      <circle cx="15" cy="20" r="10" fill="#8b5cf6"/>
      <text x="35" y="18" font-family="Inter, system-ui, sans-serif" font-size="13" fill="white">Layer</text>
      <text x="35" y="35" font-family="Inter, system-ui, sans-serif" font-size="11" fill="#64748b">Offline debugging</text>
    </g>

    <g transform="translate(900, 25)">
      <circle cx="15" cy="20" r="10" fill="#f97316"/>
      <text x="35" y="18" font-family="Inter, system-ui, sans-serif" font-size="13" fill="white">System</text>
      <text x="35" y="35" font-family="Inter, system-ui, sans-serif" font-size="11" fill="#64748b">Deep profiling only</text>
    </g>

    <g transform="translate(1300, 25)">
      <rect width="400" height="50" rx="8" fill="#14532d"/>
      <text x="200" y="32" font-family="Inter, system-ui, sans-serif" font-size="13" fill="#86efac" text-anchor="middle">Start with Request → escalate if needed</text>
    </g>
  </g>

  <!-- Bottom tagline -->
  <g transform="translate(60, 890)">
    <text x="900" y="25" font-family="Inter, system-ui, sans-serif" font-size="14" fill="#64748b" text-anchor="middle">Mieruka: Make the invisible visible — trace at the right level for your problem</text>
  </g>
</svg>
