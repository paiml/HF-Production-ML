<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 500">
  <defs>
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#4F46E5"/>
      <stop offset="100%" style="stop-color:#7C3AED"/>
    </linearGradient>
    <linearGradient id="boxGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#F8FAFC"/>
      <stop offset="100%" style="stop-color:#E2E8F0"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.15"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="800" height="500" fill="#FAFAFA"/>

  <!-- Title -->
  <rect x="0" y="0" width="800" height="50" fill="url(#headerGrad)"/>
  <text x="400" y="32" font-family="system-ui, sans-serif" font-size="20" font-weight="600" fill="white" text-anchor="middle">TGI Architecture: High-Performance Inference Server</text>

  <!-- Request Queue -->
  <g transform="translate(50, 80)" filter="url(#shadow)">
    <rect width="140" height="100" rx="8" fill="url(#boxGrad)" stroke="#CBD5E1" stroke-width="1"/>
    <rect width="140" height="28" rx="8" fill="#3B82F6"/>
    <text x="70" y="19" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="white" text-anchor="middle">Request Queue</text>
    <text x="70" y="55" font-family="monospace" font-size="10" fill="#475569" text-anchor="middle">Priority scheduling</text>
    <text x="70" y="70" font-family="monospace" font-size="10" fill="#475569" text-anchor="middle">Backpressure control</text>
    <text x="70" y="85" font-family="monospace" font-size="10" fill="#475569" text-anchor="middle">Rate limiting</text>
  </g>

  <!-- Arrow 1 -->
  <path d="M 195 130 L 235 130" stroke="#94A3B8" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#94A3B8"/></marker></defs>

  <!-- Batch Scheduler -->
  <g transform="translate(240, 80)" filter="url(#shadow)">
    <rect width="140" height="100" rx="8" fill="url(#boxGrad)" stroke="#CBD5E1" stroke-width="1"/>
    <rect width="140" height="28" rx="8" fill="#10B981"/>
    <text x="70" y="19" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="white" text-anchor="middle">Batch Scheduler</text>
    <text x="70" y="55" font-family="monospace" font-size="10" fill="#475569" text-anchor="middle">Continuous batching</text>
    <text x="70" y="70" font-family="monospace" font-size="10" fill="#475569" text-anchor="middle">Dynamic insertion</text>
    <text x="70" y="85" font-family="monospace" font-size="10" fill="#475569" text-anchor="middle">Sequence grouping</text>
  </g>

  <!-- Arrow 2 -->
  <path d="M 385 130 L 425 130" stroke="#94A3B8" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>

  <!-- Model Executor -->
  <g transform="translate(430, 80)" filter="url(#shadow)">
    <rect width="140" height="100" rx="8" fill="url(#boxGrad)" stroke="#CBD5E1" stroke-width="1"/>
    <rect width="140" height="28" rx="8" fill="#F59E0B"/>
    <text x="70" y="19" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="white" text-anchor="middle">Model Executor</text>
    <text x="70" y="55" font-family="monospace" font-size="10" fill="#475569" text-anchor="middle">Flash Attention</text>
    <text x="70" y="70" font-family="monospace" font-size="10" fill="#475569" text-anchor="middle">Tensor parallelism</text>
    <text x="70" y="85" font-family="monospace" font-size="10" fill="#475569" text-anchor="middle">CUDA graphs</text>
  </g>

  <!-- Arrow 3 -->
  <path d="M 575 130 L 615 130" stroke="#94A3B8" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>

  <!-- KV Cache -->
  <g transform="translate(620, 80)" filter="url(#shadow)">
    <rect width="130" height="100" rx="8" fill="url(#boxGrad)" stroke="#CBD5E1" stroke-width="1"/>
    <rect width="130" height="28" rx="8" fill="#EF4444"/>
    <text x="65" y="19" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="white" text-anchor="middle">KV Cache</text>
    <text x="65" y="55" font-family="monospace" font-size="10" fill="#475569" text-anchor="middle">Paged memory</text>
    <text x="65" y="70" font-family="monospace" font-size="10" fill="#475569" text-anchor="middle">Block allocation</text>
    <text x="65" y="85" font-family="monospace" font-size="10" fill="#475569" text-anchor="middle">Copy-on-write</text>
  </g>

  <!-- Data Flow Section -->
  <g transform="translate(50, 220)">
    <text x="0" y="0" font-family="system-ui, sans-serif" font-size="14" font-weight="600" fill="#1E293B">Inference Pipeline Flow</text>

    <!-- Pipeline boxes -->
    <g transform="translate(0, 20)">
      <rect x="0" y="0" width="100" height="40" rx="4" fill="#DBEAFE" stroke="#3B82F6" stroke-width="1"/>
      <text x="50" y="25" font-family="system-ui, sans-serif" font-size="11" fill="#1E40AF" text-anchor="middle">Tokenize</text>

      <path d="M 105 20 L 125 20" stroke="#94A3B8" stroke-width="1.5" marker-end="url(#arrowhead)"/>

      <rect x="130" y="0" width="100" height="40" rx="4" fill="#DCFCE7" stroke="#10B981" stroke-width="1"/>
      <text x="180" y="25" font-family="system-ui, sans-serif" font-size="11" fill="#166534" text-anchor="middle">Prefill</text>

      <path d="M 235 20 L 255 20" stroke="#94A3B8" stroke-width="1.5" marker-end="url(#arrowhead)"/>

      <rect x="260" y="0" width="100" height="40" rx="4" fill="#FEF3C7" stroke="#F59E0B" stroke-width="1"/>
      <text x="310" y="25" font-family="system-ui, sans-serif" font-size="11" fill="#92400E" text-anchor="middle">Decode</text>

      <path d="M 365 20 L 385 20" stroke="#94A3B8" stroke-width="1.5" marker-end="url(#arrowhead)"/>

      <rect x="390" y="0" width="100" height="40" rx="4" fill="#FCE7F3" stroke="#EC4899" stroke-width="1"/>
      <text x="440" y="25" font-family="system-ui, sans-serif" font-size="11" fill="#9D174D" text-anchor="middle">Sample</text>

      <path d="M 495 20 L 515 20" stroke="#94A3B8" stroke-width="1.5" marker-end="url(#arrowhead)"/>

      <rect x="520" y="0" width="100" height="40" rx="4" fill="#E0E7FF" stroke="#6366F1" stroke-width="1"/>
      <text x="570" y="25" font-family="system-ui, sans-serif" font-size="11" fill="#3730A3" text-anchor="middle">Detokenize</text>

      <path d="M 625 20 L 645 20" stroke="#94A3B8" stroke-width="1.5" marker-end="url(#arrowhead)"/>

      <rect x="650" y="0" width="80" height="40" rx="4" fill="#F0FDF4" stroke="#22C55E" stroke-width="2"/>
      <text x="690" y="25" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#15803D" text-anchor="middle">Output</text>
    </g>
  </g>

  <!-- Qwen Model Info -->
  <g transform="translate(50, 320)">
    <rect width="700" height="130" rx="8" fill="#F8FAFC" stroke="#E2E8F0" stroke-width="1"/>
    <text x="20" y="25" font-family="system-ui, sans-serif" font-size="14" font-weight="600" fill="#1E293B">Qwen2.5-Coder Model Tiers</text>

    <!-- Tier boxes -->
    <g transform="translate(20, 40)">
      <rect x="0" y="0" width="150" height="70" rx="6" fill="#DBEAFE" stroke="#3B82F6" stroke-width="1"/>
      <text x="75" y="20" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#1E40AF" text-anchor="middle">Tiny (0.5B)</text>
      <text x="75" y="38" font-family="monospace" font-size="9" fill="#475569" text-anchor="middle">hidden: 896</text>
      <text x="75" y="52" font-family="monospace" font-size="9" fill="#475569" text-anchor="middle">layers: 24</text>
      <text x="75" y="66" font-family="monospace" font-size="9" fill="#475569" text-anchor="middle">~1GB VRAM</text>
    </g>

    <g transform="translate(185, 40)">
      <rect x="0" y="0" width="150" height="70" rx="6" fill="#DCFCE7" stroke="#10B981" stroke-width="1"/>
      <text x="75" y="20" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#166534" text-anchor="middle">Small (1.5B)</text>
      <text x="75" y="38" font-family="monospace" font-size="9" fill="#475569" text-anchor="middle">hidden: 1536</text>
      <text x="75" y="52" font-family="monospace" font-size="9" fill="#475569" text-anchor="middle">layers: 28</text>
      <text x="75" y="66" font-family="monospace" font-size="9" fill="#475569" text-anchor="middle">~3GB VRAM</text>
    </g>

    <g transform="translate(350, 40)">
      <rect x="0" y="0" width="150" height="70" rx="6" fill="#FEF3C7" stroke="#F59E0B" stroke-width="1"/>
      <text x="75" y="20" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#92400E" text-anchor="middle">Medium (7B)</text>
      <text x="75" y="38" font-family="monospace" font-size="9" fill="#475569" text-anchor="middle">hidden: 3584</text>
      <text x="75" y="52" font-family="monospace" font-size="9" fill="#475569" text-anchor="middle">layers: 28</text>
      <text x="75" y="66" font-family="monospace" font-size="9" fill="#475569" text-anchor="middle">~14GB VRAM</text>
    </g>

    <g transform="translate(515, 40)">
      <rect x="0" y="0" width="150" height="70" rx="6" fill="#FCE7F3" stroke="#EC4899" stroke-width="1"/>
      <text x="75" y="20" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#9D174D" text-anchor="middle">Large (32B)</text>
      <text x="75" y="38" font-family="monospace" font-size="9" fill="#475569" text-anchor="middle">hidden: 5120</text>
      <text x="75" y="52" font-family="monospace" font-size="9" fill="#475569" text-anchor="middle">layers: 64</text>
      <text x="75" y="66" font-family="monospace" font-size="9" fill="#475569" text-anchor="middle">~64GB VRAM</text>
    </g>
  </g>

  <!-- Footer -->
  <text x="400" y="480" font-family="system-ui, sans-serif" font-size="10" fill="#94A3B8" text-anchor="middle">Course 5: Production ML with Hugging Face | Week 1: Inference Fundamentals</text>
</svg>
