<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1920 1080">
  <defs>
    <linearGradient id="signGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" stop-color="#22c55e"/>
      <stop offset="100%" stop-color="#16a34a"/>
    </linearGradient>
    <linearGradient id="verifyGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" stop-color="#3b82f6"/>
      <stop offset="100%" stop-color="#1d4ed8"/>
    </linearGradient>
    <linearGradient id="dangerGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" stop-color="#ef4444"/>
      <stop offset="100%" stop-color="#dc2626"/>
    </linearGradient>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#64748b"/>
    </marker>
    <marker id="arrowGreen" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#22c55e"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1920" height="1080" fill="#020617"/>

  <!-- Title -->
  <text x="960" y="50" text-anchor="middle" fill="#f8fafc" font-family="Inter, system-ui, sans-serif" font-size="36" font-weight="700">2.4 Model Signing and Supply Chain Security</text>
  <text x="960" y="85" text-anchor="middle" fill="#64748b" font-family="Inter, system-ui, sans-serif" font-size="16">Cryptographic Verification from Training to Deployment</text>

  <!-- Main Flow: Left to Right -->
  <!-- Step 1: Train -->
  <g transform="translate(200, 320)">
    <rect x="-140" y="-100" width="280" height="200" rx="16" fill="#0f172a" stroke="#8b5cf6" stroke-width="3"/>
    <circle cx="0" cy="-50" r="35" fill="#2e1065" stroke="#8b5cf6" stroke-width="2"/>
    <text x="0" y="-45" text-anchor="middle" fill="#a78bfa" font-family="Inter, system-ui, sans-serif" font-size="20">1</text>
    <text x="0" y="10" text-anchor="middle" fill="#a78bfa" font-family="Inter, system-ui, sans-serif" font-size="20" font-weight="700">TRAIN</text>
    <text x="0" y="40" text-anchor="middle" fill="#64748b" font-family="Inter, system-ui, sans-serif" font-size="12">Generate weights</text>
    <text x="0" y="60" text-anchor="middle" fill="#64748b" font-family="Inter, system-ui, sans-serif" font-size="12">Record provenance</text>
  </g>

  <line x1="345" y1="320" x2="455" y2="320" stroke="#64748b" stroke-width="3" marker-end="url(#arrow)"/>

  <!-- Step 2: Sign -->
  <g transform="translate(560, 320)">
    <rect x="-140" y="-100" width="280" height="200" rx="16" fill="#0f172a" stroke="#22c55e" stroke-width="3"/>
    <rect x="-130" y="-90" width="260" height="180" rx="12" fill="url(#signGrad)" opacity="0.15"/>
    <circle cx="0" cy="-50" r="35" fill="#052e16" stroke="#22c55e" stroke-width="2"/>
    <text x="0" y="-45" text-anchor="middle" fill="#4ade80" font-family="Inter, system-ui, sans-serif" font-size="20">2</text>
    <text x="0" y="10" text-anchor="middle" fill="#4ade80" font-family="Inter, system-ui, sans-serif" font-size="20" font-weight="700">SIGN</text>
    <text x="0" y="40" text-anchor="middle" fill="#64748b" font-family="Inter, system-ui, sans-serif" font-size="12">Ed25519 signature</text>
    <text x="0" y="60" text-anchor="middle" fill="#64748b" font-family="Inter, system-ui, sans-serif" font-size="12">SHA-256 checksum</text>
  </g>

  <line x1="705" y1="320" x2="815" y2="320" stroke="#22c55e" stroke-width="3" marker-end="url(#arrowGreen)"/>

  <!-- Step 3: Publish -->
  <g transform="translate(920, 320)">
    <rect x="-140" y="-100" width="280" height="200" rx="16" fill="#0f172a" stroke="#f59e0b" stroke-width="3"/>
    <circle cx="0" cy="-50" r="35" fill="#451a03" stroke="#f59e0b" stroke-width="2"/>
    <text x="0" y="-45" text-anchor="middle" fill="#fbbf24" font-family="Inter, system-ui, sans-serif" font-size="20">3</text>
    <text x="0" y="10" text-anchor="middle" fill="#fbbf24" font-family="Inter, system-ui, sans-serif" font-size="20" font-weight="700">PUBLISH</text>
    <text x="0" y="40" text-anchor="middle" fill="#64748b" font-family="Inter, system-ui, sans-serif" font-size="12">Upload to registry</text>
    <text x="0" y="60" text-anchor="middle" fill="#64748b" font-family="Inter, system-ui, sans-serif" font-size="12">Attach metadata</text>
  </g>

  <line x1="1065" y1="320" x2="1175" y2="320" stroke="#64748b" stroke-width="3" marker-end="url(#arrow)"/>

  <!-- Step 4: Download -->
  <g transform="translate(1280, 320)">
    <rect x="-140" y="-100" width="280" height="200" rx="16" fill="#0f172a" stroke="#06b6d4" stroke-width="3"/>
    <circle cx="0" cy="-50" r="35" fill="#083344" stroke="#06b6d4" stroke-width="2"/>
    <text x="0" y="-45" text-anchor="middle" fill="#22d3ee" font-family="Inter, system-ui, sans-serif" font-size="20">4</text>
    <text x="0" y="10" text-anchor="middle" fill="#22d3ee" font-family="Inter, system-ui, sans-serif" font-size="20" font-weight="700">DOWNLOAD</text>
    <text x="0" y="40" text-anchor="middle" fill="#64748b" font-family="Inter, system-ui, sans-serif" font-size="12">apr pull</text>
    <text x="0" y="60" text-anchor="middle" fill="#64748b" font-family="Inter, system-ui, sans-serif" font-size="12">Fetch artifacts</text>
  </g>

  <line x1="1425" y1="320" x2="1535" y2="320" stroke="#64748b" stroke-width="3" marker-end="url(#arrow)"/>

  <!-- Step 5: Verify -->
  <g transform="translate(1640, 320)">
    <rect x="-140" y="-100" width="280" height="200" rx="16" fill="#0f172a" stroke="#3b82f6" stroke-width="3"/>
    <rect x="-130" y="-90" width="260" height="180" rx="12" fill="url(#verifyGrad)" opacity="0.15"/>
    <circle cx="0" cy="-50" r="35" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2"/>
    <text x="0" y="-45" text-anchor="middle" fill="#60a5fa" font-family="Inter, system-ui, sans-serif" font-size="20">5</text>
    <text x="0" y="10" text-anchor="middle" fill="#60a5fa" font-family="Inter, system-ui, sans-serif" font-size="20" font-weight="700">VERIFY</text>
    <text x="0" y="40" text-anchor="middle" fill="#64748b" font-family="Inter, system-ui, sans-serif" font-size="12">Check signature</text>
    <text x="0" y="60" text-anchor="middle" fill="#64748b" font-family="Inter, system-ui, sans-serif" font-size="12">Validate checksum</text>
  </g>

  <!-- Signature Detail Box (Bottom Left) -->
  <g transform="translate(400, 700)">
    <rect x="-340" y="-150" width="680" height="300" rx="16" fill="#0f172a" stroke="#22c55e" stroke-width="2"/>
    <text x="0" y="-115" text-anchor="middle" fill="#4ade80" font-family="Inter, system-ui, sans-serif" font-size="18" font-weight="600">Ed25519 Signing Process</text>

    <!-- Key pair -->
    <g transform="translate(-220, -30)">
      <rect x="-80" y="-50" width="160" height="100" rx="8" fill="#1e293b" stroke="#22c55e" stroke-width="2"/>
      <text x="0" y="-25" text-anchor="middle" fill="#4ade80" font-family="Inter, system-ui, sans-serif" font-size="12" font-weight="600">Private Key</text>
      <text x="0" y="0" text-anchor="middle" fill="#64748b" font-family="JetBrains Mono, monospace" font-size="9">ed25519.key</text>
      <rect x="-60" y="15" width="120" height="20" rx="4" fill="#052e16"/>
      <text x="0" y="30" text-anchor="middle" fill="#86efac" font-family="JetBrains Mono, monospace" font-size="8">SECRET</text>
    </g>

    <line x1="-55" y1="-30" x2="25" y2="-30" stroke="#22c55e" stroke-width="2" marker-end="url(#arrowGreen)"/>

    <!-- Sign operation -->
    <g transform="translate(80, -30)">
      <rect x="-50" y="-50" width="100" height="100" rx="8" fill="#052e16" stroke="#22c55e" stroke-width="2"/>
      <text x="0" y="5" text-anchor="middle" fill="#4ade80" font-family="Inter, system-ui, sans-serif" font-size="14" font-weight="700">SIGN</text>
    </g>

    <line x1="135" y1="-30" x2="215" y2="-30" stroke="#22c55e" stroke-width="2" marker-end="url(#arrowGreen)"/>

    <!-- Signature output -->
    <g transform="translate(270, -30)">
      <rect x="-50" y="-50" width="100" height="100" rx="8" fill="#1e293b" stroke="#4ade80" stroke-width="2"/>
      <text x="0" y="-10" text-anchor="middle" fill="#86efac" font-family="Inter, system-ui, sans-serif" font-size="11">Signature</text>
      <text x="0" y="10" text-anchor="middle" fill="#64748b" font-family="JetBrains Mono, monospace" font-size="8">64 bytes</text>
    </g>

    <!-- Model input -->
    <g transform="translate(80, 90)">
      <rect x="-150" y="-30" width="300" height="60" rx="8" fill="#1e293b"/>
      <text x="0" y="-5" text-anchor="middle" fill="#94a3b8" font-family="Inter, system-ui, sans-serif" font-size="11">Model Weights + Config + Tokenizer</text>
      <text x="0" y="15" text-anchor="middle" fill="#64748b" font-family="JetBrains Mono, monospace" font-size="9">SHA-256 hash of contents</text>
    </g>

    <line x1="80" y1="55" x2="80" y2="25" stroke="#64748b" stroke-width="2" marker-end="url(#arrow)"/>
  </g>

  <!-- Danger Zone (Bottom Right) -->
  <g transform="translate(1200, 700)">
    <rect x="-340" y="-150" width="680" height="300" rx="16" fill="#0f172a" stroke="#ef4444" stroke-width="2"/>
    <text x="0" y="-115" text-anchor="middle" fill="#f87171" font-family="Inter, system-ui, sans-serif" font-size="18" font-weight="600">Supply Chain Threats</text>

    <!-- Threat boxes -->
    <g transform="translate(-200, 0)">
      <rect x="-100" y="-80" width="200" height="160" rx="8" fill="#450a0a" stroke="#ef4444" stroke-width="2"/>
      <text x="0" y="-50" text-anchor="middle" fill="#fca5a5" font-family="Inter, system-ui, sans-serif" font-size="14" font-weight="600">Pickle Attack</text>
      <text x="0" y="-25" text-anchor="middle" fill="#64748b" font-family="Inter, system-ui, sans-serif" font-size="10">Arbitrary code in .pt</text>
      <rect x="-80" y="-10" width="160" height="60" rx="4" fill="#1e293b"/>
      <text x="0" y="10" text-anchor="middle" fill="#ef4444" font-family="JetBrains Mono, monospace" font-size="9">__reduce__</text>
      <text x="0" y="25" text-anchor="middle" fill="#ef4444" font-family="JetBrains Mono, monospace" font-size="9">os.system(...)</text>
    </g>

    <g transform="translate(50, 0)">
      <rect x="-100" y="-80" width="200" height="160" rx="8" fill="#450a0a" stroke="#ef4444" stroke-width="2"/>
      <text x="0" y="-50" text-anchor="middle" fill="#fca5a5" font-family="Inter, system-ui, sans-serif" font-size="14" font-weight="600">Weight Swap</text>
      <text x="0" y="-25" text-anchor="middle" fill="#64748b" font-family="Inter, system-ui, sans-serif" font-size="10">Backdoored model</text>
      <rect x="-80" y="-10" width="160" height="60" rx="4" fill="#1e293b"/>
      <text x="0" y="10" text-anchor="middle" fill="#ef4444" font-family="Inter, system-ui, sans-serif" font-size="9">Trojan trigger</text>
      <text x="0" y="25" text-anchor="middle" fill="#ef4444" font-family="Inter, system-ui, sans-serif" font-size="9">hidden behavior</text>
    </g>

    <g transform="translate(300, 0)">
      <rect x="-100" y="-80" width="200" height="160" rx="8" fill="#052e16" stroke="#22c55e" stroke-width="2"/>
      <text x="0" y="-50" text-anchor="middle" fill="#4ade80" font-family="Inter, system-ui, sans-serif" font-size="14" font-weight="600">SafeTensors/APR</text>
      <text x="0" y="-25" text-anchor="middle" fill="#64748b" font-family="Inter, system-ui, sans-serif" font-size="10">No code execution</text>
      <rect x="-80" y="-10" width="160" height="60" rx="4" fill="#1e293b"/>
      <text x="0" y="10" text-anchor="middle" fill="#22c55e" font-family="Inter, system-ui, sans-serif" font-size="9">Data only format</text>
      <text x="0" y="25" text-anchor="middle" fill="#22c55e" font-family="Inter, system-ui, sans-serif" font-size="9">Signature verified</text>
    </g>
  </g>

  <!-- Footer -->
  <text x="960" y="1060" text-anchor="middle" fill="#475569" font-family="Inter, system-ui, sans-serif" font-size="14">Model Security: Ed25519 Signatures + SHA-256 Checksums + No Pickle</text>
</svg>
